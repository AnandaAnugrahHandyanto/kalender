<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Kalender Libur Nasional</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0; padding: 0;
        background-color: var(--bg-color);
        color: var(--text-color);
        transition: background 0.3s, color 0.3s;
    }
    :root {
        --bg-color: #ffffff;
        --text-color: #000000;
        --accent-color: #1a73e8;
        --holiday-color: #e53935;
    }
    body.dark {
        --bg-color: #121212;
        --text-color: #ffffff;
        --accent-color: #90caf9;
        --holiday-color: #ff8a80;
    }
    header {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        background: var(--accent-color);
        color: white;
        gap: 10px;
    }
    header h1 {
        flex: 1 1 auto;
        margin: 0;
        text-align: center;
        min-width: 180px;
    }
    .calendar {
        max-width: 600px;
        margin: auto;
        padding: 10px;
    }
    .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 5px;
    }
    .calendar-grid > div {
        text-align: center;
        user-select: none;
    }
    .calendar-grid > div.header-day {
        font-weight: bold;
        font-size: 0.9rem;
        padding: 5px 0;
        border-bottom: 2px solid var(--accent-color);
    }
    .calendar-grid > div.day {
        padding: 12px 6px;
        border-radius: 6px;
        font-size: 1rem;
        line-height: 1.2;
        position: relative;
        cursor: default;
        transition: background 0.2s, color 0.2s;
    }
    .calendar-grid > div.day.holiday {
        background: none;
        cursor: pointer;
    }
    .calendar-grid > div.day.holiday > span.holiday-number {
        color: var(--holiday-color);
        font-weight: 700;
        text-decoration: underline; /* garis bawah tambahan */
    }
    .calendar-grid > div.day:hover {
        background: var(--accent-color);
        color: white;
        cursor: pointer;
    }
    /* Tanda khusus untuk hari ini */
    .calendar-grid > div.day.today {
        border: 2px solid var(--accent-color);
        font-weight: 700;
        box-shadow: 0 0 6px var(--accent-color);
        background: var(--bg-color);
        color: var(--accent-color);
    }
    body.dark .calendar-grid > div.day.today {
        background: #263238;
        color: var(--accent-color);
    }

    #holidayDescription {
        display: none;
        max-width: 600px;
        margin: 10px auto;
        padding: 10px;
        font-size: 1rem;
        min-height: 40px;
        color: var(--holiday-color);
        border: 1px solid var(--holiday-color);
        border-radius: 6px;
        background: var(--holiday-bg, #feeaea);
        user-select: text;
    }
    body.dark #holidayDescription {
        --holiday-bg: #3b1f1f;
    }

    /* Tombol dan input */
    .controls {
        display: flex;
        align-items: center;
        gap: 5px;
    }
    button {
        padding: 6px 12px;
        border: none;
        border-radius: 5px;
        background: var(--accent-color);
        color: white;
        cursor: pointer;
        font-size: 1rem;
        transition: background 0.3s;
    }
    button:hover {
        background: #145dbf;
    }
    input[type=number] {
        width: 80px;
        padding: 5px 8px;
        border-radius: 5px;
        border: none;
        font-size: 1rem;
        text-align: center;
    }
</style>
</head>
<body>
<header>
    <button id="prevMonth" title="Bulan sebelumnya">âŸ¨</button>
    <h1 id="monthYear"></h1>
    <button id="nextMonth" title="Bulan berikutnya">âŸ©</button>
    <div class="controls">
        <input type="number" id="yearInput" min="1900" max="2100" step="1" title="Masukkan tahun" />
        <button id="goYearBtn" title="Lihat tahun">Lihat Tahun</button>
    </div>
    <button id="toggleMode" title="Toggle mode gelap/terang">ðŸŒ™</button>
</header>
<div class="calendar">
    <div class="calendar-grid" id="calendarDays"></div>
</div>
<div id="holidayDescription"></div>

<script>
const apiKey = "AIzaSyCHdJfqVSd-1rQ1wbbp7uaJwk9Ty2iWRAE";
const calendarId = "id.indonesian#holiday@group.v.calendar.google.com";

let currentDate = new Date();
let holidays = {};
const dayNames = ["Minggu", "Senin", "Selasa", "Rabu", "Kamis", "Jumat", "Sabtu"];

async function fetchHolidays(year) {
    const timeMin = `${year}-01-01T00:00:00Z`;
    const timeMax = `${year}-12-31T23:59:59Z`;
    const url = `https://www.googleapis.com/calendar/v3/calendars/${encodeURIComponent(calendarId)}/events?key=${apiKey}&timeMin=${timeMin}&timeMax=${timeMax}&singleEvents=true&orderBy=startTime`;
    const res = await fetch(url);
    const data = await res.json();
    holidays = {};
    if (data.items) {
        data.items.forEach(event => {
            const date = event.start.date;
            holidays[date] = event.summary;
        });
    }
}

function renderCalendar() {
    const monthYear = document.getElementById("monthYear");
    const calendarDays = document.getElementById("calendarDays");
    calendarDays.innerHTML = "";

    const year = currentDate.getFullYear();
    const month = currentDate.getMonth();
    const firstDay = new Date(year, month, 1).getDay();
    const daysInMonth = new Date(year, month + 1, 0).getDate();

    monthYear.textContent = currentDate.toLocaleString("id-ID", { month: "long", year: "numeric" });

    // Header nama hari
    dayNames.forEach(day => {
        calendarDays.innerHTML += `<div class="header-day">${day}</div>`;
    });

    // Kosongkan sebelum tanggal 1
    for (let i = 0; i < firstDay; i++) {
        calendarDays.innerHTML += `<div></div>`;
    }

    const today = new Date();

    // Tanggal dan libur
    for (let day = 1; day <= daysInMonth; day++) {
        const dateStr = `${year}-${String(month + 1).padStart(2, "0")}-${String(day).padStart(2, "0")}`;
        const dateObj = new Date(year, month, day);
        const isSunday = dateObj.getDay() === 0;
        const isHoliday = holidays[dateStr];
        const isToday = (year === today.getFullYear() && month === today.getMonth() && day === today.getDate());

        const holidayClass = (isSunday || isHoliday) ? "holiday" : "";
        const todayClass = isToday ? "today" : "";

        const classes = [holidayClass, todayClass].filter(Boolean).join(" ");

        // Bungkus angka tanggal dengan span jika hari libur supaya bisa diwarnai merah
        const dayNumber = (isSunday || isHoliday)
            ? `<span class="holiday-number">${day}</span>`
            : day;

        calendarDays.innerHTML += `
            <div class="day ${classes}" data-date="${dateStr}" data-desc="${isHoliday ? holidays[dateStr] : ''}">
                ${dayNumber}
            </div>
        `;
    }

    addHolidayClickListeners();
}

function addHolidayClickListeners() {
    const holidayDesc = document.getElementById("holidayDescription");

    // Klik hari libur tampilkan keterangan dan show kotak
    document.querySelectorAll(".calendar-grid > div.day.holiday").forEach(dayEl => {
        dayEl.addEventListener("click", () => {
            const desc = dayEl.getAttribute("data-desc");
            const date = dayEl.getAttribute("data-date");
            holidayDesc.textContent = `${date}: ${desc}`;
            holidayDesc.style.display = "block"; // tampilkan kotak
        });
    });

    // Klik hari biasa sembunyikan kotak keterangan
    document.querySelectorAll(".calendar-grid > div.day:not(.holiday)").forEach(dayEl => {
        dayEl.addEventListener("click", () => {
            holidayDesc.style.display = "none"; // sembunyikan kotak
        });
    });
}

document.getElementById("prevMonth").addEventListener("click", () => {
    currentDate.setMonth(currentDate.getMonth() - 1);
    checkAndRender();
});
document.getElementById("nextMonth").addEventListener("click", () => {
    currentDate.setMonth(currentDate.getMonth() + 1);
    checkAndRender();
});
document.getElementById("toggleMode").addEventListener("click", () => {
    document.body.classList.toggle("dark");
});
document.getElementById("goYearBtn").addEventListener("click", () => {
    const inputYear = parseInt(document.getElementById("yearInput").value);
    if (inputYear >= 1900 && inputYear <= 2100) {
        currentDate.setFullYear(inputYear);
        currentDate.setMonth(0);
        checkAndRender();
    } else {
        alert("Masukkan tahun antara 1900 sampai 2100.");
    }
});

// Set default tahun input
document.getElementById("yearInput").value = currentDate.getFullYear();

async function checkAndRender() {
    const year = currentDate.getFullYear();
    await fetchHolidays(year);
    renderCalendar();
}

checkAndRender();
</script>
</body>
</html>
